@model List<Neighborly.Models.ListingViewModel>
@{
    ViewData["Title"] = "Moje konto";
    var userListings = Model;
    Layout = "~/Views/Shared/Listings_layout.cshtml";
}

<div class="space-y-6">
    <div class="flex items-center justify-between">
        <h1 class="text-3xl font-bold text-gray-900">Moje Konto</h1>
        <a asp-page="/nowe-ogloszenie" class="btn inline-flex items-center">
            <svg class="h-4 w-4 mr-2" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5v14m7-7H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            Dodaj ogłoszenie
        </a>
    </div>

    <div class="w-full" id="tabs">
        <div class="grid w-full grid-cols-3" role="tablist">
            <button class="flex items-center" id="tab-listings" data-tab="listings" role="tab">
                <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M5 12h14M12 5l7 7-7 7" stroke-linecap="round" stroke-linejoin="round"/></svg>
                Moje ogłoszenia
            </button>
            <button class="flex items-center" id="tab-messages" data-tab="messages" role="tab">
                <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z" stroke-linecap="round" stroke-linejoin="round"/></svg>
                Wiadomości
            </button>
            <button class="flex items-center" id="tab-settings" data-tab="settings" role="tab">
                <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M11.983 1a2 2 0 012 2v2.058a8.005 8.005 0 013.888 1.768l1.453-1.453a2 2 0 012.828 2.828l-1.453 1.453A8.005 8.005 0 0120.942 11H23a2 2 0 012 2v0a2 2 0 01-2 2h-2.058a8.005 8.005 0 01-1.768 3.888l1.453 1.453a2 2 0 01-2.828 2.828l-1.453-1.453A8.005 8.005 0 0113.983 20.942V23a2 2 0 01-2 2h0a2 2 0 01-2-2v-2.058a8.005 8.005 0 01-3.888-1.768l-1.453 1.453a2 2 0 01-2.828-2.828l1.453-1.453A8.005 8.005 0 013.058 13H1a2 2 0 01-2-2v0a2 2 0 012-2h2.058a8.005 8.005 0 011.768-3.888L3.373 4.659a2 2 0 012.828-2.828l1.453 1.453A8.005 8.005 0 0111.983 3.058V1a2 2 0 012-2z" stroke-linecap="round" stroke-linejoin="round"/></svg>
                Ustawienia
            </button>
        </div>

        <div id="listings" class="mt-6" role="tabpanel">
            <div class="border rounded-lg p-4">
                <h2 class="font-semibold mb-4">Moje ogłoszenia (@Model.UserListings.Count)</h2>
                @if (Model.UserListings.Any())
                {
                    <div class="space-y-4">
                    @foreach (var listing in Model.UserListings)
                    {
                        <div class="border rounded-lg p-4 hover:bg-gray-50">
                            <div class="flex justify-between items-start">
                                <div class="flex-1">
                                    <div class="flex items-center gap-2 mb-2">
                                        <h3 class="font-semibold text-lg">@listing.Title</h3>
                                        <span class="@(listing.Type == "offer" ? "badge" : "badge-secondary")">
                                            @(listing.Type == "offer" ? "Oferuję pomoc" : "Szukam pomocy")
                                        </span>
                                    </div>
                                    <p class="text-gray-600 mb-2">@listing.Description</p>
                                    <div class="text-sm text-gray-500">
                                        <span>Dodano: @listing.CreatedAt.ToString("dd.MM.yyyy")</span>
                                        <span class="mx-2">•</span>
                                        <span>@listing.Location.District, @listing.Location.City</span>
                                    </div>
                                </div>
                                <div class="flex items-center gap-2 ml-4">
                                    <a asp-page="/ogloszenie" asp-route-id="@listing.Id" class="btn btn-outline btn-sm">
                                        <svg class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                                    </a>
                                    <a asp-page="/edytuj-ogloszenie" asp-route-id="@listing.Id" class="btn btn-outline btn-sm">
                                        <svg class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 013 3L7 19l-4 1 1-4 12.5-12.5z"/></svg>
                                    </a>
                                    <button type="button" class="btn btn-outline btn-sm" asp-page-handler="Delete" asp-route-id="@listing.Id">
                                        <svg class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 6h18"/><path d="M8 6v14a2 2 0 002 2h4a2 2 0 002-2V6M10 11v6M14 11v6M5 6V4a2 2 0 012-2h10a2 2 0 012 2v2"/></svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    }
                    </div>
                }
                else
                {
                    <div class="text-center py-8">
                        <svg class="h-12 w-12 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 00-3-3.87"/><path d="M4 19v-2a4 4 0 013-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/><path d="M8 3.13a4 4 0 000 7.75"/></svg>
                        <h3 class="text-lg font-medium text-gray-900 mb-2">Nie masz jeszcze żadnych ogłoszeń</h3>
                        <p class="text-gray-500 mb-4">Rozpocznij pomaganie sąsiadom lub poproś o pomoc.</p>
                        <a asp-page="/nowe-ogloszenie" class="btn inline-flex items-center">
                            <svg class="h-4 w-4 mr-2" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5v14m7-7H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                            Dodaj pierwsze ogłoszenie
                        </a>
                    </div>
                }
            </div>
        </div>

        <div id="messages" class="mt-6" role="tabpanel">
            <div class="border rounded-lg p-4">
                <h2 class="font-semibold mb-4">Wiadomości</h2>
                <div class="text-center py-8">
                    <svg class="h-12 w-12 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    <h3 class="text-lg font-medium text-gray-900 mb-2">Nie masz jeszcze żadnych wiadomości</h3>
                    <p class="text-gray-500 mb-4">Gdy ktoś skontaktuje się z Tobą w sprawie ogłoszenia, zobaczysz to tutaj.</p>
                    <a asp-page="/chaty" class="btn inline-flex items-center">
                        <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z" stroke-linecap="round" stroke-linejoin="round"/></svg>
                        Przejdź do chatów
                    </a>
                </div>
            </div>
        </div>

        <div id="settings" class="mt-6" role="tabpanel">
            <div class="border rounded-lg p-4">
                <h2 class="font-semibold mb-4">Ustawienia konta</h2>
                <div class="space-y-4">
                    <div>
                        <h4 class="font-medium mb-2">Profil</h4>
                        <p class="text-sm text-gray-600 mb-3">Zarządzaj swoimi danymi osobowymi i ustawieniami profilu.</p>
                        <div class="flex gap-2">
                            <a asp-page="/profil" class="btn btn-outline inline-flex items-center">
                                <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 00-3-3.87"/><path d="M4 19v-2a4 4 0 013-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/><path d="M8 3.13a4 4 0 000 7.75"/></svg>
                                Zobacz profil
                            </a>
                            <a asp-page="/edytuj-profil" class="btn inline-flex items-center">
                                <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 013 3L7 19l-4 1 1-4 12.5-12.5z"/></svg>
                                Edytuj profil
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Simple tab switcher
const tabs = document.querySelectorAll('[role="tab"]');
const tabPanels = document.querySelectorAll('[role="tabpanel"]');

tabs.forEach(tab => {
    tab.addEventListener('click', () => {
        const target = tab.getAttribute('data-tab');
        tabs.forEach(t => t.classList.remove('active'));
        tabPanels.forEach(panel => {
            panel.style.display = panel.id === target ? 'block' : 'none';
        });
        tab.classList.add('active');
    });
});

// Initialize first tab
if (tabs.length > 0) {
    tabs[0].click();
}
</script>
